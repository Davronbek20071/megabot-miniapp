var Qe;function In(e){return{lang:e?.lang??Qe?.lang,message:e?.message,abortEarly:e?.abortEarly??Qe?.abortEarly,abortPipeEarly:e?.abortPipeEarly??Qe?.abortPipeEarly}}var ys;function ms(e){return ys?.get(e)}var gs;function vs(e){return gs?.get(e)}var ws;function $s(e,t){return ws?.get(e)?.get(t)}function ks(e){const t=typeof e;return t==="string"?`"${e}"`:t==="number"||t==="bigint"||t==="boolean"?`${e}`:t==="object"||t==="function"?(e&&Object.getPrototypeOf(e)?.constructor?.name)??"null":t}function P(e,t,n,r,s){const o=s&&"input"in s?s.input:n.value,a=s?.expected??e.expects??null,i=s?.received??ks(o),u={kind:e.kind,type:e.type,input:o,expected:a,received:i,message:`Invalid ${t}: ${a?`Expected ${a} but r`:"R"}eceived ${i}`,requirement:e.requirement,path:s?.path,issues:s?.issues,lang:r.lang,abortEarly:r.abortEarly,abortPipeEarly:r.abortPipeEarly},c=e.kind==="schema",l=s?.message??e.message??$s(e.reference,u.lang)??(c?vs(u.lang):null)??r.message??ms(u.lang);l!==void 0&&(u.message=typeof l=="function"?l(u):l),c&&(n.typed=!1),n.issues?n.issues.push(u):n.issues=[u]}function q(e){return{version:1,vendor:"valibot",validate(t){return e["~run"]({value:t},In())}}}function Tn(e,t){return Object.hasOwn(e,t)&&t!=="__proto__"&&t!=="prototype"&&t!=="constructor"}function Es(e,t){const n=[...new Set(e)];return n.length>1?`(${n.join(` ${t} `)})`:n[0]??"never"}var ct=class extends Error{constructor(e){super(e[0].message),this.name="ValiError",this.issues=e}};function On(e){return{kind:"transformation",type:"transform",reference:On,async:!1,operation:e,"~run"(t){return t.value=this.operation(t.value),t}}}function xs(e,t,n){return typeof e.fallback=="function"?e.fallback(t,n):e.fallback}function wt(e,t,n){return typeof e.default=="function"?e.default(t,n):e.default}function Ln(e,t){return!e["~run"]({value:t},{abortEarly:!0}).issues}function Vn(e,t){return{kind:"schema",type:"array",reference:Vn,expects:"Array",async:!1,item:e,message:t,get"~standard"(){return q(this)},"~run"(n,r){const s=n.value;if(Array.isArray(s)){n.typed=!0,n.value=[];for(let o=0;o<s.length;o++){const a=s[o],i=this.item["~run"]({value:a},r);if(i.issues){const u={type:"array",origin:"value",input:s,key:o,value:a};for(const c of i.issues)c.path?c.path.unshift(u):c.path=[u],n.issues?.push(c);if(n.issues||(n.issues=i.issues),r.abortEarly){n.typed=!1;break}}i.typed||(n.typed=!1),n.value.push(i.value)}}else P(this,"type",n,r);return n}}}function lt(e){return{kind:"schema",type:"boolean",reference:lt,expects:"boolean",async:!1,message:e,get"~standard"(){return q(this)},"~run"(t,n){return typeof t.value=="boolean"?t.typed=!0:P(this,"type",t,n),t}}}function Dn(e){return{kind:"schema",type:"date",reference:Dn,expects:"Date",async:!1,message:e,get"~standard"(){return q(this)},"~run"(t,n){return t.value instanceof Date?isNaN(t.value)?P(this,"type",t,n,{received:'"Invalid Date"'}):t.typed=!0:P(this,"type",t,n),t}}}function $t(e){return{kind:"schema",type:"function",reference:$t,expects:"Function",async:!1,message:e,get"~standard"(){return q(this)},"~run"(t,n){return typeof t.value=="function"?t.typed=!0:P(this,"type",t,n),t}}}function Rn(e,t){return{kind:"schema",type:"instance",reference:Rn,expects:e.name,async:!1,class:e,message:t,get"~standard"(){return q(this)},"~run"(n,r){return n.value instanceof this.class?n.typed=!0:P(this,"type",n,r),n}}}function L(e,t){return{kind:"schema",type:"loose_object",reference:L,expects:"Object",async:!1,entries:e,message:t,get"~standard"(){return q(this)},"~run"(n,r){const s=n.value;if(s&&typeof s=="object"){n.typed=!0,n.value={};for(const o in this.entries){const a=this.entries[o];if(o in s||(a.type==="exact_optional"||a.type==="optional"||a.type==="nullish")&&a.default!==void 0){const i=o in s?s[o]:wt(a),u=a["~run"]({value:i},r);if(u.issues){const c={type:"object",origin:"value",input:s,key:o,value:i};for(const l of u.issues)l.path?l.path.unshift(c):l.path=[c],n.issues?.push(l);if(n.issues||(n.issues=u.issues),r.abortEarly){n.typed=!1;break}}u.typed||(n.typed=!1),n.value[o]=u.value}else if(a.fallback!==void 0)n.value[o]=xs(a);else if(a.type!=="exact_optional"&&a.type!=="optional"&&a.type!=="nullish"&&(P(this,"key",n,r,{input:void 0,expected:`"${o}"`,path:[{type:"object",origin:"key",input:s,key:o,value:s[o]}]}),r.abortEarly))break}if(!n.issues||!r.abortEarly)for(const o in s)Tn(s,o)&&!(o in this.entries)&&(n.value[o]=s[o])}else P(this,"type",n,r);return n}}}function ce(e,t){return{kind:"schema",type:"nullish",reference:ce,expects:`(${e.expects} | null | undefined)`,async:!1,wrapped:e,default:t,get"~standard"(){return q(this)},"~run"(n,r){return(n.value===null||n.value===void 0)&&(this.default!==void 0&&(n.value=wt(this,n,r)),n.value===null||n.value===void 0)?(n.typed=!0,n):this.wrapped["~run"](n,r)}}}function qe(e){return{kind:"schema",type:"number",reference:qe,expects:"number",async:!1,message:e,get"~standard"(){return q(this)},"~run"(t,n){return typeof t.value=="number"&&!isNaN(t.value)?t.typed=!0:P(this,"type",t,n),t}}}function je(e,t){return{kind:"schema",type:"optional",reference:je,expects:`(${e.expects} | undefined)`,async:!1,wrapped:e,default:t,get"~standard"(){return q(this)},"~run"(n,r){return n.value===void 0&&(this.default!==void 0&&(n.value=wt(this,n,r)),n.value===void 0)?(n.typed=!0,n):this.wrapped["~run"](n,r)}}}function Wn(e,t,n){return{kind:"schema",type:"record",reference:Wn,expects:"Object",async:!1,key:e,value:t,message:n,get"~standard"(){return q(this)},"~run"(r,s){const o=r.value;if(o&&typeof o=="object"){r.typed=!0,r.value={};for(const a in o)if(Tn(o,a)){const i=o[a],u=this.key["~run"]({value:a},s);if(u.issues){const l={type:"object",origin:"key",input:o,key:a,value:i};for(const p of u.issues)p.path=[l],r.issues?.push(p);if(r.issues||(r.issues=u.issues),s.abortEarly){r.typed=!1;break}}const c=this.value["~run"]({value:i},s);if(c.issues){const l={type:"object",origin:"value",input:o,key:a,value:i};for(const p of c.issues)p.path?p.path.unshift(l):p.path=[l],r.issues?.push(p);if(r.issues||(r.issues=c.issues),s.abortEarly){r.typed=!1;break}}(!u.typed||!c.typed)&&(r.typed=!1),u.typed&&(r.value[u.value]=c.value)}}else P(this,"type",r,s);return r}}}function $(e){return{kind:"schema",type:"string",reference:$,expects:"string",async:!1,message:e,get"~standard"(){return q(this)},"~run"(t,n){return typeof t.value=="string"?t.typed=!0:P(this,"type",t,n),t}}}function en(e){let t;if(e)for(const n of e)t?t.push(...n.issues):t=n.issues;return t}function Bn(e,t){return{kind:"schema",type:"union",reference:Bn,expects:Es(e.map(n=>n.expects),"|"),async:!1,options:e,message:t,get"~standard"(){return q(this)},"~run"(n,r){let s,o,a;for(const i of this.options){const u=i["~run"]({value:n.value},r);if(u.typed)if(u.issues)o?o.push(u):o=[u];else{s=u;break}else a?a.push(u):a=[u]}if(s)return s;if(o){if(o.length===1)return o[0];P(this,"type",n,r,{issues:en(o)}),n.typed=!0}else{if(a?.length===1)return a[0];P(this,"type",n,r,{issues:en(a)})}return n}}}function Mn(){return{kind:"schema",type:"unknown",reference:Mn,expects:"unknown",async:!1,get"~standard"(){return q(this)},"~run"(e){return e.typed=!0,e}}}function te(e,t,n){const r=e["~run"]({value:t},In(n));if(r.issues)throw new ct(r.issues);return r.value}function Se(...e){return{...e[0],pipe:e,get"~standard"(){return q(this)},"~run"(t,n){for(const r of e)if(r.kind!=="metadata"){if(t.issues&&(r.kind==="schema"||r.kind==="transformation")){t.typed=!1;break}(!t.issues||!n.abortEarly&&!n.abortPipeEarly)&&(t=r["~run"](t,n))}return t}}}var As=Object.defineProperty,Ss=(e,t,n)=>t in e?As(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,pt=(e,t,n)=>Ss(e,typeof t!="symbol"?t+"":t,n),qs=Object.defineProperty,js=(e,t,n)=>t in e?qs(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Cs=(e,t,n)=>js(e,t+"",n);function Ps(e,t){return n=>n instanceof e&&n.type===t}function Nn(e,t){t||(t=[]);const n=Symbol(e);class r extends Error{constructor(...o){const a=typeof t=="function"?t(...o):typeof t=="string"?[t]:t||[];super(...a),Cs(this,"type",n),this.name=e}}return Object.defineProperty(r,"name",{value:e}),[r,Ps(r,n)]}const[Is,Ts]=Nn("CancelledError","Promise was canceled"),[Os]=Nn("TimeoutError",(e,t)=>[`Timeout reached: ${e}ms`,{cause:t}]),Un=Symbol("Resolved");function tn(e){return Array.isArray(e)&&e[0]===Un}function Ls(e){return[Un,e]}function nn(e,t){return e.reject=t.reject,e.abort=t.abort,e}let k=class ft extends Promise{constructor(t,n){let r,s;super((o,a)=>{let i,u;typeof t=="function"?(i=t,u=n):u=t;const c=[],l=f=>(...Y)=>{const Ae=f(...Y);return c.forEach(bs=>bs()),Ae},p=new AbortController,{signal:b}=p;s=f=>{!b.aborted&&p.abort(f)};const m=()=>b.reason,R=f=>{const Y=()=>{f(m())};b.addEventListener("abort",Y,!0);const Ae=()=>{b.removeEventListener("abort",Y,!0)};return c.push(Ae),Ae},xe=l(f=>{o(f),s(Ls(f))});r=l(f=>{a(f),s(f)}),u||(u={});const{abortSignal:B,rejectOnAbort:ie=!0}=u;if(B)if(B.aborted){const{reason:f}=B;if(ie)return r(f);s(f)}else{const f=()=>{s(B.reason)};B.addEventListener("abort",f),c.push(()=>{B.removeEventListener("abort",f)})}ie&&R(a);const{timeout:E}=u;if(E){const f=setTimeout(()=>{s(new Os(E))},E);c.push(()=>{clearTimeout(f)})}const v=()=>b.aborted,W=()=>tn(m()),M=()=>{const f=m();return tn(f)?f[1]:void 0};try{const f=i&&i(xe,r,{abortReason:m,abortSignal:b,isAborted:v,isResolved:W,onAborted:R,onResolved:Y=>R(()=>{W()&&Y(M())}),resolved:M,throwIfAborted(){if(v())throw m()}});f instanceof Promise&&f.catch(r)}catch(f){r(f)}}),pt(this,"abort"),pt(this,"reject"),this.abort=s,this.reject=r}static fn(t,n){return new ft(async(r,s,o)=>{try{r(await t(o))}catch(a){s(a)}},n)}static resolve(t){return this.fn(()=>t)}static reject(t){return new ft((n,r)=>{r(t)})}cancel(){this.abort(new Is)}catch(t){return this.then(void 0,t)}finally(t){return nn(super.finally(t),this)}then(t,n){return nn(super.then(t,n),this)}};function rn(e,t){return e.resolve=t.resolve,e}let Vs=class _t extends k{constructor(t,n){let r,s;typeof t=="function"?(r=t,s=n):s=t;let o;super((a,i,u)=>{o=a,r&&r(a,i,u)},s),pt(this,"resolve"),this.resolve=o}static fn(t,n){return new _t((r,s,o)=>{try{Promise.resolve(t(o)).then(r,s)}catch(a){s(a)}},n)}static resolve(t){return this.fn(()=>t)}static reject(t){return new _t((n,r)=>{r(t)})}catch(t){return this.then(void 0,t)}finally(t){return rn(super.finally(t),this)}then(t,n){return rn(super.then(t,n),this)}};function Fn(e){return e.replace(/[A-Z]/g,t=>`-${t.toLowerCase()}`)}function Ds(e){return e.replace(/_([a-z])/g,(t,n)=>`-${n.toLowerCase()}`)}function Gn(e){return`tapps/${e}`}function V(e,t){sessionStorage.setItem(Gn(e),JSON.stringify(t))}function j(e){const t=sessionStorage.getItem(Gn(e));try{return t?JSON.parse(t):void 0}catch{}}function kt(...e){const t=e.flat(1);return[t.push.bind(t),()=>{t.forEach(n=>{n()})}]}function Rs(e,t){t||(t={});const{textColor:n,bgColor:r,shouldLog:s}=t,o=s===void 0?!0:s,a=typeof o=="boolean"?()=>o:o,i=(u,c,...l)=>{if(c||a()){const p="font-weight:bold;padding:0 5px;border-radius:100px",[b,m,R]={log:["#0089c3","white","INFO"],error:["#ff0000F0","white","ERR"],warn:["#D38E15","white","WARN"]}[u];console[u](`%c${R} ${Intl.DateTimeFormat("en-GB",{hour:"2-digit",minute:"2-digit",second:"2-digit",fractionalSecondDigits:3,timeZone:"UTC"}).format(new Date)}%c %c${e}`,`${p};background-color:${b};color:${m}`,"",`${p};${n?`color:${n};`:""}${r?`background-color:${r}`:""}`,...l)}};return[["log","forceLog"],["warn","forceWarn"],["error","forceError"]].reduce((u,[c,l])=>(u[c]=i.bind(void 0,c,!1),u[l]=i.bind(void 0,c,!0),u),{})}function zn(e){return{lang:e?.lang??void 0,message:e?.message,abortEarly:e?.abortEarly??void 0,abortPipeEarly:e?.abortPipeEarly??void 0}}function Ws(e,t){var n;return(n=void 0)==null?void 0:n.get(t)}function Bs(e){var t,n;const r=typeof e;return r==="string"?`"${e}"`:r==="number"||r==="bigint"||r==="boolean"?`${e}`:r==="object"||r==="function"?(e&&((n=(t=Object.getPrototypeOf(e))==null?void 0:t.constructor)==null?void 0:n.name))??"null":r}function I(e,t,n,r,s){const o=s&&"input"in s?s.input:n.value,a=s?.expected??e.expects??null,i=s?.received??Bs(o),u={kind:e.kind,type:e.type,input:o,expected:a,received:i,message:`Invalid ${t}: ${a?`Expected ${a} but r`:"R"}eceived ${i}`,requirement:e.requirement,path:s?.path,issues:s?.issues,lang:r.lang,abortEarly:r.abortEarly,abortPipeEarly:r.abortPipeEarly},c=e.kind==="schema",l=s?.message??e.message??Ws(e.reference,u.lang)??(c?(u.lang,void 0):null)??r.message??(u.lang,void 0);l&&(u.message=typeof l=="function"?l(u):l),c&&(n.typed=!1),n.issues?n.issues.push(u):n.issues=[u]}function D(e){return{version:1,vendor:"valibot",validate(t){return e["~run"]({value:t},zn())}}}function Hn(e,t){return Object.hasOwn(e,t)&&t!=="__proto__"&&t!=="prototype"&&t!=="constructor"}function Ms(e,t){const n=[...new Set(e)];return n.length>1?`(${n.join(` ${t} `)})`:n[0]??"never"}var Ns=class extends Error{constructor(e){super(e[0].message),this.name="ValiError",this.issues=e}};function Kn(e,t){return{kind:"validation",type:"check",reference:Kn,async:!1,expects:null,requirement:e,message:t,"~run"(n,r){return n.typed&&!this.requirement(n.value)&&I(this,"input",n,r),n}}}function Jn(e){return{kind:"validation",type:"integer",reference:Jn,async:!1,expects:null,requirement:Number.isInteger,message:e,"~run"(t,n){return t.typed&&!this.requirement(t.value)&&I(this,"integer",t,n),t}}}function U(e){return{kind:"transformation",type:"transform",reference:U,async:!1,operation:e,"~run"(t){return t.value=this.operation(t.value),t}}}function Zn(e,t,n){return typeof e.default=="function"?e.default(t,n):e.default}function Us(e,t){return!e["~run"]({value:t},{abortEarly:!0}).issues}function le(e){return{kind:"schema",type:"boolean",reference:le,expects:"boolean",async:!1,message:e,get"~standard"(){return D(this)},"~run"(t,n){return typeof t.value=="boolean"?t.typed=!0:I(this,"type",t,n),t}}}function Xn(e){return{kind:"schema",type:"date",reference:Xn,expects:"Date",async:!1,message:e,get"~standard"(){return D(this)},"~run"(t,n){return t.value instanceof Date?isNaN(t.value)?I(this,"type",t,n,{received:'"Invalid Date"'}):t.typed=!0:I(this,"type",t,n),t}}}function Yn(e,t){return{kind:"schema",type:"instance",reference:Yn,expects:e.name,async:!1,class:e,message:t,get"~standard"(){return D(this)},"~run"(n,r){return n.value instanceof this.class?n.typed=!0:I(this,"type",n,r),n}}}function Et(e){return{kind:"schema",type:"lazy",reference:Et,expects:"unknown",async:!1,getter:e,get"~standard"(){return D(this)},"~run"(t,n){return this.getter(t.value)["~run"](t,n)}}}function re(e,t){return{kind:"schema",type:"loose_object",reference:re,expects:"Object",async:!1,entries:e,message:t,get"~standard"(){return D(this)},"~run"(n,r){var s;const o=n.value;if(o&&typeof o=="object"){n.typed=!0,n.value={};for(const a in this.entries){const i=this.entries[a];if(a in o||(i.type==="exact_optional"||i.type==="optional"||i.type==="nullish")&&i.default!==void 0){const u=a in o?o[a]:Zn(i),c=i["~run"]({value:u},r);if(c.issues){const l={type:"object",origin:"value",input:o,key:a,value:u};for(const p of c.issues)p.path?p.path.unshift(l):p.path=[l],(s=n.issues)==null||s.push(p);if(n.issues||(n.issues=c.issues),r.abortEarly){n.typed=!1;break}}c.typed||(n.typed=!1),n.value[a]=c.value}else if(i.type!=="exact_optional"&&i.type!=="optional"&&i.type!=="nullish"&&(I(this,"key",n,r,{input:void 0,expected:`"${a}"`,path:[{type:"object",origin:"key",input:o,key:a,value:o[a]}]}),r.abortEarly))break}if(!n.issues||!r.abortEarly)for(const a in o)Hn(o,a)&&!(a in this.entries)&&(n.value[a]=o[a])}else I(this,"type",n,r);return n}}}function Te(e){return{kind:"schema",type:"number",reference:Te,expects:"number",async:!1,message:e,get"~standard"(){return D(this)},"~run"(t,n){return typeof t.value=="number"&&!isNaN(t.value)?t.typed=!0:I(this,"type",t,n),t}}}function y(e,t){return{kind:"schema",type:"optional",reference:y,expects:`(${e.expects} | undefined)`,async:!1,wrapped:e,default:t,get"~standard"(){return D(this)},"~run"(n,r){return n.value===void 0&&(this.default!==void 0&&(n.value=Zn(this,n,r)),n.value===void 0)?(n.typed=!0,n):this.wrapped["~run"](n,r)}}}function Qn(e,t,n){return{kind:"schema",type:"record",reference:Qn,expects:"Object",async:!1,key:e,value:t,message:n,get"~standard"(){return D(this)},"~run"(r,s){var o,a;const i=r.value;if(i&&typeof i=="object"){r.typed=!0,r.value={};for(const u in i)if(Hn(i,u)){const c=i[u],l=this.key["~run"]({value:u},s);if(l.issues){const b={type:"object",origin:"key",input:i,key:u,value:c};for(const m of l.issues)m.path=[b],(o=r.issues)==null||o.push(m);if(r.issues||(r.issues=l.issues),s.abortEarly){r.typed=!1;break}}const p=this.value["~run"]({value:c},s);if(p.issues){const b={type:"object",origin:"value",input:i,key:u,value:c};for(const m of p.issues)m.path?m.path.unshift(b):m.path=[b],(a=r.issues)==null||a.push(m);if(r.issues||(r.issues=p.issues),s.abortEarly){r.typed=!1;break}}(!l.typed||!p.typed)&&(r.typed=!1),l.typed&&(r.value[l.value]=p.value)}}else I(this,"type",r,s);return r}}}function _(e){return{kind:"schema",type:"string",reference:_,expects:"string",async:!1,message:e,get"~standard"(){return D(this)},"~run"(t,n){return typeof t.value=="string"?t.typed=!0:I(this,"type",t,n),t}}}function sn(e){let t;if(e)for(const n of e)t?t.push(...n.issues):t=n.issues;return t}function xt(e,t){return{kind:"schema",type:"union",reference:xt,expects:Ms(e.map(n=>n.expects),"|"),async:!1,options:e,message:t,get"~standard"(){return D(this)},"~run"(n,r){let s,o,a;for(const i of this.options){const u=i["~run"]({value:n.value},r);if(u.typed)if(u.issues)o?o.push(u):o=[u];else{s=u;break}else a?a.push(u):a=[u]}if(s)return s;if(o){if(o.length===1)return o[0];I(this,"type",n,r,{issues:sn(o)}),n.typed=!0}else{if(a?.length===1)return a[0];I(this,"type",n,r,{issues:sn(a)})}return n}}}function er(){return{kind:"schema",type:"unknown",reference:er,expects:"unknown",async:!1,get"~standard"(){return D(this)},"~run"(e){return e.typed=!0,e}}}function tr(e,t,n){const r=e["~run"]({value:t},zn(n));if(r.issues)throw new Ns(r.issues);return r.value}function F(...e){return{...e[0],pipe:e,get"~standard"(){return D(this)},"~run"(t,n){for(const r of e)if(r.kind!=="metadata"){if(t.issues&&(r.kind==="schema"||r.kind==="transformation")){t.typed=!1;break}(!t.issues||!n.abortEarly&&!n.abortPipeEarly)&&(t=r["~run"](t,n))}return t}}}function Fs(e){return e.replace(/_[a-z]/g,t=>t[1].toUpperCase())}function Gs(e){return Object.entries(e).reduce((t,[n,r])=>(t[Fs(n)]=r,t),{})}function dt(e){const t=Gs(e);for(const n in t){const r=t[n];r&&typeof r=="object"&&!(r instanceof Date)&&(t[n]=Array.isArray(r)?r.map(dt):dt(r))}return t}function At(e){return U(t=>e?dt(t):t)}function nr(e){return t=>F(e,At(t))}function zs(e){return(t,n)=>tr(F(e,At(n)),t)}function St(){return U(JSON.parse)}function qt(e){const t=nr(e);return n=>F(_(),St(),t(n))}function rr(e){return U(t=>{const n={};return new URLSearchParams(t).forEach((r,s)=>{const o=n[s];Array.isArray(o)?o.push(r):o===void 0?n[s]=r:n[s]=[o,r]}),tr(e,n)})}function sr(e){return t=>F(xt([_(),Yn(URLSearchParams)]),rr(e),At(t))}const on=y(Et(()=>Xs())),Hs=re({id:Te(),photo_url:y(_()),type:_(),title:_(),username:y(_())}),Ks=re({added_to_attachment_menu:y(le()),allows_write_to_pm:y(le()),first_name:_(),id:Te(),is_bot:y(le()),is_premium:y(le()),last_name:y(_()),language_code:y(_()),photo_url:y(_()),username:y(_())}),Js=re({auth_date:F(_(),U(e=>new Date(Number(e)*1e3)),Xn()),can_send_after:y(F(_(),U(Number),Jn())),chat:y(Et(()=>Zs())),chat_type:y(_()),chat_instance:y(_()),hash:_(),query_id:y(_()),receiver:on,start_param:y(_()),signature:_(),user:on}),Zs=qt(Hs),Xs=qt(Ks),Ys=sr(Js);function ve(e){return/^#[\da-f]{6}$/i.test(e)}const or=nr(Qn(_(),F(xt([_(),Te()]),U(e=>typeof e=="number"?`#${(e&16777215).toString(16).padStart(6,"0")}`:e),Kn(ve)))),et=y(F(_(),U(e=>e==="1"))),an=qt(or()),Qs=re({tgWebAppBotInline:et,tgWebAppData:y(Ys()),tgWebAppDefaultColors:y(an()),tgWebAppFullscreen:et,tgWebAppPlatform:_(),tgWebAppShowSettings:et,tgWebAppStartParam:y(_()),tgWebAppThemeParams:an(),tgWebAppVersion:_()}),ar=sr(Qs),ir=zs(ar()),eo=re({eventType:_(),eventData:y(er())});function to(e){try{return Us(ar(),e)}catch{return!1}}function no(e){return{all:e=e||new Map,on:function(t,n){var r=e.get(t);r?r.push(n):e.set(t,[n])},off:function(t,n){var r=e.get(t);r&&(n?r.splice(r.indexOf(n)>>>0,1):e.set(t,[]))},emit:function(t,n){var r=e.get(t);r&&r.slice().map(function(s){s(n)}),(r=e.get("*"))&&r.slice().map(function(s){s(t,n)})}}}let ee;function ro(e,t){ee&&ee.set(e,t)||t()}function he(e){if(ee)return e();ee=new Map;try{e()}finally{ee.forEach(t=>t()),ee=void 0}}function we(e,t){t||(t={});const n=t.equals||Object.is;let r=[],s=e;const o=c=>{if(!n(s,c)){const l=s;s=c,ro(u,()=>{[...r].forEach(([p,b])=>{p(c,l),b&&i(p,!0)})})}};function a(c){const l=typeof c!="object"?{once:c}:c;return{once:l.once||!1,signal:l.signal||!1}}const i=(c,l)=>{const p=a(l),b=r.findIndex(([m,R])=>m===c&&R.once===p.once&&R.signal===p.signal);b>=0&&r.splice(b,1)},u=Object.assign(function(){return so(u),s},{destroy(){r=[]},set:o,reset(){o(e)},sub(c,l){return r.push([c,a(l)]),()=>i(c,l)},unsub:i,unsubAll(){r=r.filter(c=>c[1].signal)}});return u}const pe=[];function so(e){pe.length&&pe[pe.length-1].add(e)}function oo(e,t){let n=new Set,r;function s(){return r||(r=we(a(),t))}function o(){s().set(a())}function a(){n.forEach(c=>{c.unsub(o,{signal:!0})});const i=new Set;let u;pe.push(i);try{u=e()}finally{pe.pop()}return i.forEach(c=>{c.sub(o,{signal:!0})}),n=i,u}return Object.assign(function(){return s()()},{destroy(){s().destroy()},sub(...i){return s().sub(...i)},unsub(...i){s().unsub(...i)},unsubAll(...i){s().unsubAll(...i)}})}var ao=Object.defineProperty,io=(e,t,n)=>t in e?ao(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,ht=(e,t,n)=>io(e,typeof t!="symbol"?t+"":t,n);function ur(e,t){return n=>n instanceof e&&n.type===t}function x(e,t){t||(t=[]);const n=Symbol(e);class r extends Error{constructor(...o){const a=typeof t=="function"?t(...o):typeof t=="string"?[t]:t||[];super(...a),ht(this,"type",n),this.name=e}}return Object.defineProperty(r,"name",{value:e}),[r,ur(r,n)]}function uo(e,t,n){const r=Symbol(e);class s extends x(e,n)[0]{constructor(...a){super(...a),ht(this,"data"),ht(this,"type",r),this.data=t(...a)}}return Object.defineProperty(s,"name",{value:e}),[s,ur(s,r)]}function cr(e){return Ln(L({TelegramWebviewProxy:L({postEvent:$t()})}),e)}function co(){try{return window.self!==window.top}catch{return!0}}function lo(e,t){const n=new Map,r=no(),s=(o,a,i)=>{i||(i=!1);const u=n.get(o)||new Map;n.set(o,u);const c=u.get(a)||[];u.set(a,c);const l=c.findIndex(p=>p[1]===i);if(l>=0&&(r.off(o,c[l][0]),c.splice(l,1),!c.length&&(u.delete(a),!u.size))){const p=n.size;n.delete(o),p&&!n.size&&t()}};return[function(o,a,i){!n.size&&e();const u=()=>{s(o,a,i)},c=(...b)=>{i&&u(),o==="*"?a(b):a(...b)};r.on(o,c);const l=n.get(o)||new Map;n.set(o,l);const p=l.get(a)||[];return l.set(a,p),p.push([c,i||!1]),u},s,r.emit,function(){const o=n.size;r.all.clear(),n.clear(),o&&t()}]}function tt(e,t){window.dispatchEvent(new MessageEvent("message",{data:JSON.stringify({eventType:e,eventData:t}),source:window.parent}))}let po=!1;const Ce=we(Rs("Bridge",{bgColor:"#9147ff",textColor:"white",shouldLog(){return po}}));function lr(e,t,n,r){Object.defineProperty(e,t,{enumerable:!0,configurable:!0,get:n,set:r})}function un(e,t){const n=e[t];lr(e,t,()=>n,r=>{Object.entries(r).forEach(([s,o])=>{n[s]=o})})}function cn(e,t,n){Object.defineProperty(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n})}function nt(e,t,n){const r=e[t],s=[n];typeof r=="function"&&s.push(r);const o=(...i)=>{s.forEach(u=>{u(...i)})},a=Object.assign((...i)=>{o(...i)},{unwrap(){const{length:i}=s;if(i===1){delete e[t];return}if(i===2){cn(e,t,s[1]);return}s.unshift(1),cn(e,t,o)}});lr(e,t,()=>a,i=>{s.push(i)})}const fo={clipboard_text_received:L({req_id:$(),data:ce($())}),custom_method_invoked:L({req_id:$(),result:je(Mn()),error:je($())}),popup_closed:ce(L({button_id:ce($(),()=>{})}),{}),viewport_changed:L({height:qe(),width:ce(qe(),()=>window.innerWidth),is_state_stable:lt(),is_expanded:lt()}),theme_changed:L({theme_params:or()})};function ln(e){if(e.source!==window.parent)return;let t;try{t=te(Se($(),St(),eo),e.data)}catch{return}const{eventType:n,eventData:r}=t,s=fo[n];let o;try{o=s?te(s,r):r}catch(a){return Ce().forceError([`An error occurred processing the "${n}" event from the Telegram application.`,"Please, file an issue here:","https://github.com/Telegram-Mini-Apps/telegram-apps/issues/new/choose"].join(`
`),t,a)}_o(n,o)}const[S,Oe,_o]=lo(()=>{const e=window;!e.TelegramGameProxy&&(e.TelegramGameProxy={}),nt(e.TelegramGameProxy,"receiveEvent",tt),un(e,"TelegramGameProxy"),!e.Telegram&&(e.Telegram={}),!e.Telegram.WebView&&(e.Telegram.WebView={}),nt(e.Telegram.WebView,"receiveEvent",tt),un(e.Telegram,"WebView"),nt(e,"TelegramGameProxy_receiveEvent",tt),window.addEventListener("message",ln)},()=>{[["TelegramGameProxy_receiveEvent"],["TelegramGameProxy","receiveEvent"],["Telegram","WebView","receiveEvent"]].forEach(e=>{const t=window;let n=[void 0,t];for(const o of e)if(n=[n[1],n[1][o]],!n[1])return;const[r,s]=n;"unwrap"in s&&(s.unwrap(),r&&r!==t&&!Object.keys(r).length&&delete t[e[0]])}),window.removeEventListener("message",ln)});x("MethodUnsupportedError",(e,t)=>[`Method "${e}" is unsupported in Mini Apps version ${t}`]);x("MethodParameterUnsupportedError",(e,t,n)=>[`Parameter "${t}" of "${e}" method is unsupported in Mini Apps version ${n}`]);const[ho]=uo("LaunchParamsRetrieveError",e=>({errors:e}),e=>[["Unable to retrieve launch parameters from any known source. Perhaps, you have opened your app outside Telegram?","ðŸ“– Refer to docs for more information:","https://docs.telegram-mini-apps.com/packages/telegram-apps-bridge/environment","","Collected errors:",...e.map(([t,n])=>`Source: ${t} / ${n instanceof Error?n.message:String(n)}`)].join(`
`)]);x("InvalidLaunchParamsError",(e,t)=>[`Invalid value for launch params: ${e}`,{cause:t}]);const[bo]=x("UnknownEnvError"),[yo]=x("InvokeCustomMethodError",e=>[`Server returned error: ${e}`]),mo=we((...e)=>{try{window.parent.postMessage(...e)}catch(t){t instanceof SyntaxError?Ce().forceError("Unable to call window.parent.postMessage due to incorrectly configured target origin. Use the setTargetOrigin method to allow this origin to receive events",t):Ce().forceError(t)}}),go=(...e)=>mo()(...e),vo=we("https://web.telegram.org");function pr(e,t){Ce().log("Posting event:",t?{eventType:e,eventData:t}:{eventType:e});const n=window,r=JSON.stringify({eventType:e,eventData:t});if(co())return go(r,vo());if(cr(n)){n.TelegramWebviewProxy.postEvent(e,JSON.stringify(t));return}if(Ln(L({external:L({notify:$t()})}),n)){n.external.notify(r);return}throw new bo}function jt(e,t,n){n||(n={});const{capture:r}=n,[s,o]=kt();return new k(a=>{(Array.isArray(t)?t:[t]).forEach(i=>{s(S(i,u=>{(!r||(Array.isArray(t)?r({event:i,payload:u}):r(u)))&&a(u)}))}),(n.postEvent||pr)(e,n.params)},n).finally(o)}const pn="launchParams";function fn(e){return e.replace(/^[^?#]*[?#]/,"").replace(/[?#]/g,"&")}function wo(){const e=[];for(const[t,n]of[[()=>fn(window.location.href),"window.location.href"],[()=>{const r=performance.getEntriesByType("navigation")[0];return r&&fn(r.name)},"performance navigation entries"],[()=>j(pn),"local storage"]]){const r=t();if(!r){e.push([n,new Error("Source is empty")]);continue}if(to(r))return V(pn,r),r;try{ir(r)}catch(s){e.push([n,s])}}throw new ho(e)}function $o(e){return ir(wo())}function _n(e,t){try{return $o(),!0}catch{return!1}return k.fn(async n=>{if(cr(window))return!0;try{return await jt("web_app_request_theme","theme_changed",n),!0}catch{return!1}},{timeout:100})}function ko(e){return({req_id:t})=>t===e}function dn(e){return e.split(".").map(Number)}function Eo(e,t){const n=dn(e),r=dn(t),s=Math.max(n.length,r.length);for(let o=0;o<s;o+=1){const a=n[o]||0,i=r[o]||0;if(a!==i)return a>i?1:-1}return 0}function w(e,t){return Eo(e,t)<=0}function bt(e,t,n){if(typeof n=="string"){if(e==="web_app_open_link"){if(t==="try_instant_view")return w("6.4",n);if(t==="try_browser")return w("7.6",n)}if(e==="web_app_set_header_color"&&t==="color")return w("6.9",n);if(e==="web_app_close"&&t==="return_back")return w("7.6",n);if(e==="web_app_setup_main_button"&&t==="has_shine_effect")return w("7.10",n)}switch(e){case"web_app_open_tg_link":case"web_app_open_invoice":case"web_app_setup_back_button":case"web_app_set_background_color":case"web_app_set_header_color":case"web_app_trigger_haptic_feedback":return w("6.1",t);case"web_app_open_popup":return w("6.2",t);case"web_app_close_scan_qr_popup":case"web_app_open_scan_qr_popup":case"web_app_read_text_from_clipboard":return w("6.4",t);case"web_app_switch_inline_query":return w("6.7",t);case"web_app_invoke_custom_method":case"web_app_request_write_access":case"web_app_request_phone":return w("6.9",t);case"web_app_setup_settings_button":return w("6.10",t);case"web_app_biometry_get_info":case"web_app_biometry_open_settings":case"web_app_biometry_request_access":case"web_app_biometry_request_auth":case"web_app_biometry_update_token":return w("7.2",t);case"web_app_setup_swipe_behavior":return w("7.7",t);case"web_app_share_to_story":return w("7.8",t);case"web_app_setup_secondary_button":case"web_app_set_bottom_bar_color":return w("7.10",t);case"web_app_request_safe_area":case"web_app_request_content_safe_area":case"web_app_request_fullscreen":case"web_app_exit_fullscreen":case"web_app_set_emoji_status":case"web_app_add_to_home_screen":case"web_app_check_home_screen":case"web_app_request_emoji_status_access":case"web_app_check_location":case"web_app_open_location_settings":case"web_app_request_file_download":case"web_app_request_location":case"web_app_send_prepared_message":case"web_app_start_accelerometer":case"web_app_start_device_orientation":case"web_app_start_gyroscope":case"web_app_stop_accelerometer":case"web_app_stop_device_orientation":case"web_app_stop_gyroscope":case"web_app_toggle_orientation_lock":return w("8.0",t);case"web_app_device_storage_clear":case"web_app_device_storage_get_key":case"web_app_device_storage_save_key":case"web_app_secure_storage_clear":case"web_app_secure_storage_get_key":case"web_app_secure_storage_restore_key":case"web_app_secure_storage_save_key":return w("9.0",t);case"web_app_hide_keyboard":return w("9.1",t);default:return["iframe_ready","iframe_will_reload","web_app_close","web_app_data_send","web_app_expand","web_app_open_link","web_app_ready","web_app_request_theme","web_app_request_viewport","web_app_setup_main_button","web_app_setup_closing_behavior"].includes(e)}}function xo(e,t,n,r){return jt("web_app_invoke_custom_method","custom_method_invoked",{...r||{},params:{method:e,params:t,req_id:n},capture:ko(n)}).then(({result:s,error:o})=>{if(o)throw new yo(o);return s})}function Ao(){return performance.getEntriesByType("navigation")[0]}function T(){const e=Ao();return!!e&&e.type==="reload"}function se(e,t){return we(e,t)}function g(e,t){return oo(e,t)}function d(e,t){const n=se(e,t);return[n,g(n)]}const rt=se(0),So=se(pr),[Oi,Le]=d({tgWebAppPlatform:"unknown",tgWebAppVersion:"0.0"}),Q=g(()=>Le().tgWebAppVersion);function qo(){return rt.set(rt()+1),rt().toString()}function $e(e,t,n){return xo(e,t,qo(),{...n||{},postEvent:h})}const A=(e,t,n)=>(n||(n={}),n.postEvent||(n.postEvent=h),jt(e,t,n)),h=(e,t)=>So()(e,t);function Z(e){return[e]}const[Ct]=x("CSSVarsBoundError","CSS variables are already bound"),[fr]=x("NotAvailableError",Z);x("InvalidEnvError",Z);const[ue]=x("FunctionNotAvailableError",Z),[N]=x("InvalidArgumentsError",(e,t)=>[e,{cause:t}]),[jo]=x("ConcurrentCallError",Z),[Co]=x("SetEmojiStatusError",e=>[`Failed to set emoji status: ${e}`]),[Po]=x("AccessDeniedError",Z),[Io]=x("FullscreenFailedError",Z);x("ShareMessageError",Z);const[Pt]=x("UnknownThemeParamsKeyError",e=>[`Unknown theme params key passed: ${e}`]);function hn(){return typeof window>"u"}function It(e,t,n){n||(n={});const{isSupported:r,isMounted:s,isMounting:o,component:a,supports:i}=n||{},u=`${a?`${a}.`:""}${e}()`,c=r?Array.isArray(r)||typeof r=="object"&&"any"in r?r:[r]:void 0;function l(E){if(i){const v=i[E];return bt(v[0],v[1],Q())}return!0}function p(){if(!c)return;function E(M){return typeof M=="function"?M():bt(M,Q())?void 0:`it is unsupported in Mini Apps version ${Q()}`}const v=Array.isArray(c)?c:c.any,W=v.map(E).filter(Boolean);return Array.isArray(c)?W[0]:W.length===v.length?W[W.length-1]:void 0}function b(...E){for(const v in i)if(i[v][2](...E)&&!l(v))return`option ${v} is not supported in Mini Apps version ${Q()}`}let m;if(i){m={};for(const E in i)m[E]=g(()=>l(E))}const R=g(()=>!p()),xe=g(()=>Q()!=="0.0"),B=g(()=>!s||s()),ie=g(()=>_n()&&!hn()&&xe()&&R()&&B());return Object.assign((...E)=>{const v=`Unable to call the ${u} ${a?"method":"function"}:`;if(hn()||!_n())throw new ue(`${v} it can't be called outside Mini Apps`);if(!xe())throw new ue(`${v} the SDK was not initialized. Use the SDK init() function`);const W=p();if(W)throw new ue(`${v} ${W}`);const M=b(...E);if(M)throw new ue(`${v} ${M}`);if(!B()){const f=o&&o()?"mounting. Wait for the mount completion":`unmounted. Use the ${a}.mount() method`;throw new ue(`${v} the component is ${f}`)}return t(...E)},t,{isAvailable:ie,ifAvailable(...E){return ie()?[!0,t(...E)]:[!1]}},c?{isSupported:R}:{},m?{supports:m}:{})}function Ve(e,t){return t||(t={}),(n,r,s,o)=>It(n,r,{...t,isSupported:s||t.isSupported,supports:o,component:e})}function G(e,t,n){return Ve(e,{isSupported:n,isMounted:t})}function O(e,t){return Ve(e,{isSupported:t})}const Tt="web_app_setup_back_button",_r="back_button_pressed",De="backButton",[bn]=d(!1),[yt]=d(!1),dr=G(De,yt,Tt),Ot=O(De,Tt);dr("hide",()=>{Lt(!1)});Ot("mount",()=>{yt()||(Lt(T()&&j(De)||!1),yt.set(!0))});function Lt(e){e!==bn()&&(h(Tt,{is_visible:e}),V(De,e),bn.set(e))}Ot("onClick",e=>S(_r,e));Ot("offClick",e=>{Oe(_r,e)});dr("show",()=>{Lt(!0)});function C(e,t,n){n||(n={});const{promise:r,error:s}=n,[o,a]=r?[r,g(r)]:d(),[i,u]=s?[s,g(s)]:d();return[Object.assign((...c)=>{if(o()){const p=new jo(t);return i.set(p),k.reject(p)}he(()=>{o.set(e(...c)),i.set(void 0)});let l;return o().catch(p=>{throw l=p,p}).finally(()=>{he(()=>{o.set(void 0),i.set(l)})})},e),[o,a,g(()=>!!o())],[i,u]]}function ke(e,t,n){const[r,...s]=C(t,`The ${e} component is already mounting`),[o,a]=d(!1);return[(...i)=>o()?k.resolve():r(...i).then(u=>{he(()=>{o.set(!0),n(u)})}),...s,[o,a]]}const[hr]=d({available:!1,type:"",accessGranted:!1,accessRequested:!1,deviceId:"",tokenSaved:!1}),yn="web_app_biometry_get_info",To=It("requestBiometry",e=>A(yn,"biometry_info_received",e),{isSupported:yn});function br(e){if(!Ts(e))throw e}function Oo(e){const t=e();t&&t.catch(br).cancel()}const be="biometry",Vt="web_app_biometry_request_auth",yr="biometry_info_received",Lo=e=>{Re(Dt(e))};function mr(){throw new fr("Biometry is not available")}function Dt(e){let t=!1,n=!1,r="",s=!1,o="",a=!1;return e.available&&(t=!0,n=e.token_saved,r=e.device_id,s=e.access_requested,o=e.type,a=e.access_granted),{available:t,tokenSaved:n,deviceId:r,type:o,accessGranted:a,accessRequested:s}}const[Vo,Do,Ro,gr]=ke(be,e=>{const t=T()&&j(be);return t?k.resolve(t):To({abortSignal:e}).then(Dt)},e=>{S(yr,Lo),Re(e)}),vr=O(be,Vt),Rt=G(be,gr[0],Vt);vr("mount",Vo);const[,Li,Vi]=Do,[,Di]=Ro,[Ri,Wi]=gr,[Wo,Bo,Mo]=C(e=>k.fn(async t=>{const n=hr();n.available||mr();const r=await A(Vt,"biometry_auth_requested",{...e,...t,params:{reason:((e||{}).reason||"").trim()}}),{token:s}=r;return typeof s=="string"&&Re({...n,token:s}),r},e),"Biometry authentication is already in progress");Rt("authenticate",Wo);const[,Bi,Mi]=Bo,[,Ni]=Mo;vr("openSettings",()=>{h("web_app_biometry_open_settings")});const[No,Uo,Fo]=C(e=>k.fn(async t=>{const n=await A("web_app_biometry_request_access",yr,{...e,...t,params:{reason:(e||{}).reason||""}}).then(Dt);return n.available||mr(),Re(n),n.accessGranted},e),"Biometry access request is already in progress");Rt("requestAccess",No);const[,Ui,Fi]=Uo,[,Gi]=Fo;function Re(e){hr.set(e),V(be,e)}Rt("updateToken",e=>(e||(e={}),A("web_app_biometry_update_token","biometry_token_updated",{...e,params:{token:e.token||"",reason:e.reason}}).then(t=>t.status)));function We(e,t){return Ve(e,{isMounted:t})}const z=Ve,Be="closingBehavior",[mn]=d(!1),[gn,Go]=d(!1),wr=We(Be,Go),zo=z(Be);wr("disableConfirmation",()=>{Wt(!1)});wr("enableConfirmation",()=>{Wt(!0)});zo("mount",()=>{gn()||(Wt(T()&&j(Be)||!1),gn.set(!0))});function Wt(e){e!==mn()&&(h("web_app_setup_closing_behavior",{need_confirmation:e}),V(Be,e),mn.set(e))}const Ho="web_app_invoke_custom_method",Ee=O("cloudStorage",Ho),Ko=Ee("deleteItem",(e,t)=>{const n=Array.isArray(e)?e:[e];return n.length?$e("deleteStorageValues",{keys:n},t).then():k.resolve()});function Jo(e,t){const n=Array.isArray(e)?e:[e];return n.length?$e("getStorageValues",{keys:n},t).then(r=>{const s={...n.reduce((o,a)=>(o[a]="",o),{}),...te(Wn($(),$()),r)};return typeof e=="string"?s[e]:s}):k.resolve(Array.isArray(e)?{}:"")}Ee("getItem",Jo);const Zo=Ee("getKeys",e=>$e("getStorageKeys",{},e).then(t=>te(Vn($()),t)));Ee("setItem",(e,t,n)=>$e("saveStorageValue",{key:e,value:t},n).then());Ee("clear",e=>Zo(e).then(Ko));const Me="web_app_trigger_haptic_feedback",Bt=O("hapticFeedback",Me);Bt("impactOccurred",e=>{h(Me,{type:"impact",impact_style:e})});Bt("notificationOccurred",e=>{h(Me,{type:"notification",notification_type:e})});Bt("selectionChanged",()=>{h(Me,{type:"selection_change"})});const $r="web_app_open_invoice",Xo=O("invoice",$r);function Yo(e,t,n){let r;if(t==="url"){const{hostname:s,pathname:o}=new URL(e,window.location.href);if(s!=="t.me")throw new N(`Link has unexpected hostname: ${s}`);const a=o.match(/^\/(\$|invoice\/)([A-Za-z0-9\-_=]+)$/);if(!a)throw new N('Expected to receive a link with a pathname in format "/invoice/{slug}" or "/${slug}"');[,,r]=a}else r=e,n=t;return A($r,"invoice_closed",{...n,params:{slug:r},capture:s=>r===s.slug}).then(s=>s.status)}const[Qo,ea,ta]=C(Yo,"Invoice is already opened");Xo("open",Qo);const[,zi,Hi]=ea,[,Ki]=ta,fe="locationManager",kr="web_app_check_location",vn="web_app_open_location_settings",mt=se({available:!1,accessGranted:!1,accessRequested:!1});function na(e){let t=!1,n,r;return e.available&&(t=!0,n=e.access_requested,r=e.access_granted),{available:t,accessGranted:r||!1,accessRequested:n||!1}}const[ra,sa,oa,Er]=ke(fe,e=>{const t=T()&&j(fe);return t?k.resolve(t):A("web_app_check_location","location_checked",e).then(na)},e=>{mt.set(e),V(fe,e)}),xr=O(fe,kr),aa=G(fe,Er[0],kr);xr("mount",ra);const[,Ji,Zi]=sa,[,Xi]=oa,[Yi,Qi]=Er,[ia,ua,ca]=C(e=>A("web_app_request_location","location_requested",e).then(t=>{if(!t.available)throw mt.set({...mt(),available:!1}),new fr("Location data tracking is not available");const{available:n,...r}=t;return r}),"Location request is currently in progress");aa("requestLocation",ia);const[,eu,tu]=ua,[,nu]=ca;xr("openSettings",()=>{h(vn)},vn);function Mt(e){const t={};for(const n in e){const r=e[n];r!==void 0&&(t[n]=r)}return t}const[st]=d(!1),[K,Ne]=d({});function Nt(e){return g(()=>K()[e])}const Ar=Nt("button_color"),la=Nt("button_text_color"),pa=Nt("secondary_bg_color"),_e=se({hasShineEffect:!1,isEnabled:!0,isLoaderVisible:!1,isVisible:!1,text:"Continue"}),fa=g(()=>{const e=_e();return{...e,backgroundColor:e.backgroundColor||Ar()||"#2481cc",textColor:e.textColor||la()||"#ffffff"}}),[wn,_a]=d(!1),da="web_app_setup_main_button",Sr="main_button_pressed",Ue="mainButton",Ut=z(Ue),ha=We(Ue,_a);Ut("mount",()=>{if(!wn()){const e=T()&&j(Ue);e&&_e.set(e),wn.set(!0)}});Ut("onClick",e=>S(Sr,e));Ut("offClick",e=>{Oe(Sr,e)});ha("setParams",e=>{_e.set({..._e(),...Mt(e)}),V(Ue,_e());const t=fa();t.text&&h(da,{color:t.backgroundColor,has_shine_effect:t.hasShineEffect,is_active:t.isEnabled,is_progress_visible:t.isLoaderVisible,is_visible:t.isVisible,text:t.text,text_color:t.textColor})});function Ft(e,t){document.documentElement.style.setProperty(e,t)}function Gt(e){document.documentElement.style.removeProperty(e)}const ne="themeParams",qr="theme_changed",jr=z(ne),Cr=({theme_params:e})=>{K.set(e),V(ne,e)},[ba,Pr,ya,Ir]=ke(ne,e=>k.resolve(T()&&j(ne)||Le().tgWebAppThemeParams||{}),e=>{S(qr,Cr),K.set(e)}),ma=We(ne,Ir[0]);ma("bindCssVars",e=>{if(st())throw new Ct;e||(e=r=>`--tg-theme-${Ds(r)}`);function t(r){Object.entries(K()).forEach(([s,o])=>{o&&r(s,o)})}function n(){t((r,s)=>{Ft(e(r),s)})}return n(),K.sub(n),st.set(!0),()=>{t(Gt),K.unsub(n),st.set(!1)}});const ga=jr("mount",ba);Pr[2];Pr[1];ya[1];const[$n,ru]=Ir,va=jr("mountSync",()=>{if(!$n()){const e=T()&&j(ne)||Le().tgWebAppThemeParams||{};S(qr,Cr),he(()=>{K.set(e),$n.set(!0)})}});function Tr(e){return g(()=>Fe(e()))}function Fe(e){return ve(e)?e:Ne()[e]}const[ye]=d("bg_color"),wa=Tr(ye),[me]=d("bottom_bar_bg_color"),Or=g(()=>{const e=me();return ve(e)?e:Ne()[e]||pa()}),[ge]=d("bg_color"),$a=Tr(ge),[ot]=d(!1),[Ge]=d(!0),ka=g(()=>({backgroundColor:ye(),bottomBarColor:me(),headerColor:ge(),isActive:Ge()})),Pe="web_app_set_background_color",Ie="web_app_set_bottom_bar_color",H="web_app_set_header_color",Lr="visibility_changed",J="miniApp",Vr={any:[Pe,Ie,H]},Dr=e=>{Ge.set(e.is_visible),He()},Rr=e=>{[[ge,H],[ye,Pe],[me,Ie]].forEach(([t,n])=>{const r=t();if(!ve(r)&&(n!==H||r!=="bg_color"&&r!=="secondary_bg_color")){const s=e[r];s&&h(n,{color:s})}})},[Ea,Wr,xa,Br]=ke(J,e=>ga(e).then(()=>T()&&j(J)||void 0),e=>{Ur.ifAvailable(e?e.backgroundColor:"bg_color"),Fr.ifAvailable(e?e.bottomBarColor:"bottom_bar_bg_color"),Gr.ifAvailable(e?e.headerColor:"bg_color"),Ge.set(e?e.isActive:!0),S(Lr,Dr),Ne.sub(Rr)}),Mr=z(J),Nr=O(J,Vr),ze=G(J,Br[0],Vr);ze("bindCssVars",e=>{if(ot())throw new Ct;const[t,n]=kt();function r(s,o){function a(){Ft(s,o()||null)}a(),t(o.sub(a),Gt.bind(null,s))}return e||(e=s=>`--tg-${Fn(s)}`),r(e("bgColor"),wa),r(e("bottomBarColor"),Or),r(e("headerColor"),$a),t(()=>{ot.set(!1)}),ot.set(!0),n});Mr("close",e=>{h("web_app_close",{return_back:e})});Nr("mount",Ea);Wr[2];Wr[1];xa[1];const[kn,su]=Br;Nr("mountSync",()=>{if(!kn()){va();const e=T()&&j(J)||void 0;Ur.ifAvailable(e?e.backgroundColor:"bg_color"),Fr.ifAvailable(e?e.bottomBarColor:"bottom_bar_bg_color"),Gr.ifAvailable(e?e.headerColor:"bg_color"),S(Lr,Dr),Ne.sub(Rr),he(()=>{Ge.set(e?e.isActive:!0),kn.set(!0)})}});Mr("ready",()=>{h("web_app_ready")});function He(){V(J,ka())}const Ur=ze("setBackgroundColor",e=>{if(e===ye())return;const t=Fe(e);if(!t)throw new Pt(e);h(Pe,{color:t}),ye.set(e),He()},Pe),Fr=ze("setBottomBarColor",e=>{if(e===me())return;const t=Fe(e);if(!t)throw new Pt(e);h(Ie,{color:t}),me.set(e),He()},Ie),Gr=ze("setHeaderColor",e=>{if(e!==ge()){if(e==="bg_color"||e==="secondary_bg_color")h(H,{color_key:e});else{const t=Fe(e);if(!t)throw new Pt(e);h(H,{color:t})}ge.set(e),He()}},H,{rgb:[H,"color",ve]});function Aa(e){const t=e.message.trim(),n=(e.title||"").trim(),r=e.buttons||[];if(n.length>64)throw new N(`Invalid title: ${n}`);if(!t||t.length>256)throw new N(`Invalid message: ${t}`);if(r.length>3)throw new N(`Invalid buttons count: ${r.length}`);return{title:n,message:t,buttons:r.length?r.map((s,o)=>{const a=s.id||"";if(a.length>64)throw new N(`Button with index ${o} has invalid id: ${a}`);if(!s.type||s.type==="default"||s.type==="destructive"){const i=s.text.trim();if(!i||i.length>64)throw new N(`Button with index ${o} has invalid text: ${i}`);return{type:s.type,text:i,id:a}}return{type:s.type,id:a}}):[{type:"close",id:""}]}}const zr="web_app_open_popup",Hr=O("popup",zr),[Kr,zt,Jr]=C(e=>A(zr,"popup_closed",{...e,params:Aa(e)}).then(({button_id:t})=>t===void 0?null:t),"A popup is already opened");Hr("open",Kr);zt[1];zt[2];Jr[1];Hr("show",Kr);const[,ou,au]=zt,[,iu]=Jr,Zr="web_app_close_scan_qr_popup",Xr="web_app_open_scan_qr_popup",Sa="scan_qr_popup_closed",qa="qr_text_received",Yr=O("qrScanner",Xr);Yr("close",()=>{h(Zr),Oo(Ta)});function ja(e){e||(e={});const{onCaptured:t,text:n,capture:r}=e,[,s]=kt(S(Sa,()=>{o.resolve()}),S(qa,a=>{t?t(a.data):(!r||r(a.data))&&(o.resolve(a.data),h(Zr))})),o=new Vs(e);return(e.postEvent||h)(Xr,{text:n}),k.resolve(o).catch(br).finally(s)}const[Ca,Pa,Ia]=C(ja,"The QR Scanner is already opened");Yr("open",Ca);const[,Ta,uu]=Pa,[,cu]=Ia,de=se({hasShineEffect:!1,isEnabled:!0,isLoaderVisible:!1,isVisible:!1,position:"left",text:"Cancel"}),Oa=g(()=>{const e=de();return{...e,backgroundColor:e.backgroundColor||Or()||"#000000",textColor:e.textColor||Ar()||"#2481cc"}}),[En,La]=d(!1),Ht="web_app_setup_secondary_button",Qr="secondary_button_pressed",Ke="secondaryButton",Kt=O(Ke,Ht),Va=G(Ke,La,Ht);Kt("mount",()=>{if(!En()){const e=T()&&j(Ke);e&&de.set(e),En.set(!0)}});Kt("onClick",e=>S(Qr,e));Kt("offClick",e=>{Oe(Qr,e)});Va("setParams",e=>{de.set({...de(),...Mt(e)}),V(Ke,de());const t=Oa();t.text&&h(Ht,{color:t.backgroundColor,has_shine_effect:t.hasShineEffect,is_active:t.isEnabled,is_progress_visible:t.isLoaderVisible,is_visible:t.isVisible,position:t.position,text:t.text,text_color:t.textColor})});const Jt="web_app_setup_settings_button",es="settings_button_pressed",Je="settingsButton",[xn]=d(!1),[gt]=d(!1),Zt=O(Je,Jt),ts=G(Je,gt,Jt);ts("hide",()=>{Xt(!1)});Zt("mount",()=>{gt()||(Xt(T()&&j(Je)||!1),gt.set(!0))});function Xt(e){e!==xn()&&(h(Jt,{is_visible:e}),V(Je,e),xn.set(e))}Zt("onClick",e=>S(es,e));Zt("offClick",e=>{Oe(es,e)});ts("show",()=>{Xt(!0)});const Yt="web_app_setup_swipe_behavior",Ze="swipeBehavior",[vt]=d(!1),[An]=d(!0),Da=O(Ze,Yt),ns=G(Ze,vt,Yt);ns("disableVertical",()=>{Qt(!1)});ns("enableVertical",()=>{Qt(!0)});Da("mount",()=>{vt()||(Qt(T()&&j(Ze)||!1,!0),vt.set(!0))});function Qt(e,t){(e!==An()||t)&&(h(Yt,{allow_vertical_swipe:e}),V(Ze,e),An.set(e))}const X="viewport",rs="fullscreen_changed",ss="safe_area_changed",os="content_safe_area_changed",as="viewport_changed",is=z(X),Sn={left:0,top:0,bottom:0,right:0};function at(e){return Math.max(e,0)}const[it,Ra]=d({contentSafeAreaInsets:Sn,height:0,isExpanded:!1,isFullscreen:!1,safeAreaInsets:Sn,stableHeight:0,width:0});function oe(e){return g(()=>Ra()[e])}const Wa=oe("height"),Ba=oe("stableHeight"),Ma=oe("width");function ae(e){const{height:t,stableHeight:n,width:r}=e;it.set({...it(),...Mt({...e,height:t?at(t):void 0,width:r?at(r):void 0,stableHeight:n?at(n):void 0})}),V(X,it())}function Na(){return j(X)}function Xe(e){return g(()=>us()[e])}const us=oe("contentSafeAreaInsets"),Ua=Xe("bottom"),Fa=Xe("left"),Ga=Xe("right"),za=Xe("top");function Ye(e){return g(()=>cs()[e])}const cs=oe("safeAreaInsets"),Ha=Ye("bottom"),Ka=Ye("left"),Ja=Ye("right"),Za=Ye("top"),ls="web_app_request_safe_area",ps=O(X,ls),qn=ps("requestContentSafeAreaInsets",e=>A("web_app_request_content_safe_area",os,e));function Xa(e){return A("web_app_request_viewport",as,e)}const jn=ps("requestSafeAreaInsets",e=>A(ls,ss,e)),Ya=e=>{const{height:t}=e;ae({isExpanded:e.is_expanded,height:t,width:e.width,stableHeight:e.is_state_stable?t:void 0})},Qa=e=>{ae({isFullscreen:e.is_fullscreen})},ei=e=>{ae({safeAreaInsets:e})},ti=e=>{ae({contentSafeAreaInsets:e})},[ni,ri,si,oi]=ke(X,e=>{const t=T()&&Na();return t?k.resolve(t):k.fn(async n=>{const r=await k.all([jn.isAvailable()?jn(n):cs(),qn.isAvailable()?qn(n):us()]),s=Le(),o={contentSafeAreaInsets:r[1],isFullscreen:!!s.tgWebAppFullscreen,safeAreaInsets:r[0]};if(["macos","tdesktop","unigram","webk","weba","web"].includes(s.tgWebAppPlatform)){const a=window;return{...o,height:a.innerHeight,isExpanded:!0,stableHeight:a.innerHeight,width:a.innerWidth}}return Xa(n).then(a=>({...o,height:a.height,isExpanded:a.is_expanded,stableHeight:a.is_state_stable?a.height:0,width:a.width}))},e)},e=>{S(as,Ya),S(rs,Qa),S(ss,ei),S(os,ti),ae(e)});is("mount",ni);const[,lu,pu]=ri,[,fu]=si,[fs,_u]=oi,ai=We(X,fs),[ut]=d(!1);ai("bindCssVars",e=>{if(ut())throw new Ct;e||(e=n=>`--tg-viewport-${Fn(n)}`);const t=[["height",Wa],["stableHeight",Ba],["width",Ma],["safeAreaInsetTop",Za],["safeAreaInsetBottom",Ha],["safeAreaInsetLeft",Ka],["safeAreaInsetRight",Ja],["contentSafeAreaInsetTop",za],["contentSafeAreaInsetBottom",Ua],["contentSafeAreaInsetLeft",Fa],["contentSafeAreaInsetRight",Ga]].reduce((n,[r,s])=>{const o=e(r);if(o){const a=()=>{Ft(o,`${s()}px`)};n.push([a,s.sub(a),o])}return n},[]);return t.forEach(n=>{n[0]()}),ut.set(!0),()=>{t.forEach(n=>{n[1](),Gt(n[2])}),ut.set(!1)}});is("expand",()=>{h("web_app_expand")});const _s="web_app_request_fullscreen",ii=G(X,fs,_s),ui=oe("isFullscreen"),[ci]=d(),[li]=d();function ds(e,t){return ii(e,C(n=>A(t?_s:"web_app_exit_fullscreen",[rs,"fullscreen_failed"],n).then(r=>{if("error"in r&&r.error!=="ALREADY_FULLSCREEN")throw new Io(r.error);const s="is_fullscreen"in r?r.is_fullscreen:!0;s!==ui()&&ae({isFullscreen:s})}),"Fullscreen mode change is already being requested",{promise:ci,error:li})[0])}ds("requestFullscreen",!0);ds("exitFullscreen");const pi="web_app_request_emoji_status_access",[du,fi,_i]=C(e=>A(pi,"emoji_status_access_requested",e).then(t=>t.status),"Emoji status access request is already in progress"),[,hu,bu]=fi,[,yu]=_i,di="web_app_set_emoji_status",[mu,hi,bi]=C((e,t)=>A(di,["emoji_status_set","emoji_status_failed"],{params:{custom_emoji_id:e,duration:(t||{}).duration},...t}).then(n=>{if(n&&"error"in n)throw new Co(n.error)}),"Emoji status set request is currently in progress"),[,gu,vu]=hi,[,wu]=bi,yi="web_app_check_home_screen",[$u,mi,gi]=C(e=>A(yi,"home_screen_checked",e).then(t=>t.status||"unknown"),"Check home screen status request is currently in progress"),[,ku,Eu]=mi,[,xu]=gi,vi=z();vi("openLink",(e,t)=>{if(typeof e=="string")try{e=new URL(e)}catch(n){throw new N(`"${e.toString()}" is invalid URL`,n)}t||(t={}),h("web_app_open_link",{url:e.toString(),try_browser:t.tryBrowser,try_instant_view:t.tryInstantView})});const Cn="web_app_open_tg_link",wi=z(),$i=wi("openTelegramLink",e=>{const t=e.toString();if(!t.match(/^https:\/\/t.me\/.+/))throw new N(`"${t}" is invalid URL`);if(!bt(Cn,Q())){window.location.href=t;return}e=new URL(e),h(Cn,{path_full:e.pathname+e.search})}),ki=z();ki("shareURL",(e,t)=>{$i("https://t.me/share/url?"+new URLSearchParams({url:e,text:t||""}).toString().replace(/\+/g,"%20"))});function Ei(e,t){return new k({abortSignal:t,timeout:e}).catch(()=>{})}const hs="web_app_request_phone",[xi,Ai,Si]=C(e=>A(hs,"phone_requested",e).then(t=>t.status),"Phone access request is currently in progress"),qi=It("requestPhoneAccess",xi,{isSupported:hs}),[,Au,Su]=Ai,[,qu]=Si;async function Pn(e){const t=te($(),await $e("getRequestedContact",{},{...e,timeout:(e||{}).timeout||5e3}));return{raw:t,parsed:te(Se(Bn([$(),Rn(URLSearchParams)]),rr(L({contact:Se($(),St(),L({user_id:qe(),phone_number:$(),first_name:$(),last_name:je($())})),auth_date:Se($(),On(n=>new Date(Number(n)*1e3)),Dn()),hash:$()}))),t)}}const[ju,ji,Ci]=C(e=>new k(async(t,n,r)=>{try{return t(await Pn(r))}catch(o){if(o instanceof ct)throw o}if(await qi(r)!=="sent")throw new Po("User denied access");let s=50;for(;!r.isAborted();){try{return t(await Pn(r))}catch(o){if(o instanceof ct)throw o}await Ei(s),s+=50}},e),"Contact is already being requested"),[,Cu,Pu]=ji,[,Iu]=Ci,Pi="web_app_request_write_access",[Tu,Ii,Ti]=C(e=>A(Pi,"write_access_requested",e).then(t=>t.status),"Write access request is currently in progress"),[,Ou,Lu]=Ii,[,Vu]=Ti;export{$o as S};
